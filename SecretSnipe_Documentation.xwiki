{{style type="text/css"}}
.info-box { background: #e3f2fd; border-left: 4px solid #2196f3; padding: 15px; margin: 10px 0; }
.success-box { background: #e8f5e8; border-left: 4px solid #4caf50; padding: 15px; margin: 10px 0; }
.warning-box { background: #fff3cd; border-left: 4px solid #ffc107; padding: 15px; margin: 10px 0; }
.code-block { background: #f5f5f5; border: 1px solid #ddd; padding: 15px; margin: 10px 0; font-family: monospace; }
{{/style}}

(% class="jumbotron" %)
(((
= ğŸ” SecretSnipe Documentation =

== Enterprise Secret Detection & Continuous Monitoring System ==

//Multi-scanner orchestration with real-time visualization and automated threat detection//
)))

== ğŸ—ï¸ System Architecture ==

=== ğŸ“Š Data Flow Architecture ===

(% class="info-box" %)
(((
**File Scanner** â†’ **PostgreSQL** â†’ **Dashboard**

**File Monitor** â†— **Redis Cache** (Real-time Processing)
)))

=== ğŸ”„ Component Interaction Flow ===

{{code language="text"}}
CIFS Mount (/mnt/secretsnipe_monitor)
    â†“
Scanner Service â†’ Custom Scanner    â†’ PostgreSQL Database
                â†’ Gitleaks         â†—
                â†’ Trufflehog      â†—

Continuous Monitor â†’ Watchdog Events â†’ Incremental Scans â†’ PostgreSQL Database

PostgreSQL Database â†’ Unified Visualizer â† Redis Cache
                           â†“
                   Web Dashboard :8050
{{/code}}

== ğŸš€ Services Overview ==

=== ğŸ” Scanner Service ===
* âœ… **Multi-engine scanning**: Custom patterns, Gitleaks, Trufflehog
* âœ… **Memory optimized**: 4GB limit, batch processing
* âœ… **OCR support**: Text extraction from images
* âœ… **File exclusions**: Skip large binaries/media

=== ğŸ‘ï¸ Continuous Monitor ===
* âœ… **Real-time watching**: File system events
* âœ… **Incremental scans**: Process only changed files
* âœ… **Cooldown protection**: Prevent duplicate scans
* âœ… **Git integration**: Diff-based change detection

=== ğŸ“Š Unified Visualizer ===
* âœ… **Real-time dashboard**: 30-second auto-refresh
* âœ… **Security features**: Rate limiting, audit logging
* âœ… **Export capabilities**: CSV, JSON reports
* âœ… **Network accessible**: Port 8050

=== ğŸ—„ï¸ Data Layer ===
* âœ… **PostgreSQL**: Persistent findings storage
* âœ… **Redis**: Caching and session management
* âœ… **Log rotation**: 100MB max, 3 files
* âœ… **Health checks**: Service monitoring

== âš™ï¸ Configuration Reference ==

=== ğŸ”§ Environment Variables (.env) ===

|=Category|=Variable|=Value|=Description
|**Scanner**|WORKER_PROCESSES|2|Number of parallel workers
|~|ENABLE_OCR|true|Enable image text extraction
|~|SCANNER_TIMEOUT_SECONDS|0|Disable timeouts
|**Exclusions**|EXCLUDED_EXTENSIONS|.pdf,.zip,.prn,.bmp,...|Skip file types
|~|EXCLUDED_DIRECTORIES|node_modules,.git,...|Skip directories
|**Network**|SCAN_VOLUME|/mnt/secretsnipe_monitor:/scan:ro|CIFS mount mapping
|~|Dashboard|0.0.0.0:8050|Network accessible UI

=== ğŸ“ File Exclusion Strategy ===

{{code}}
# Large Binary Files (Memory Protection)
.pdf, .zip, .rar, .7z          # Archives & documents
.prn, .bmp, .tiff, .tif         # Print/image files
.mov, .mp4, .avi, .mkv          # Video files

# Directory Exclusions (Performance)
node_modules, .git, __pycache__ # Build artifacts
venv, .venv, build, dist        # Environment dirs
{{/code}}

== ğŸ³ Docker Architecture ==

=== ğŸ—ï¸ Service Stack ===

{{code language="yaml"}}
services:
  secretsnipe-postgres:    # Database (Port 5432)
  secretsnipe-redis:       # Cache (Port 6379)
  secretsnipe-scanner:     # Main scanner engine
  secretsnipe-continuous:  # File change monitor
  secretsnipe-visualizer:  # Web dashboard (Port 8050)
  secretsnipe-webhook:     # API endpoints
{{/code}}

=== ğŸ’¾ Resource Allocation ===

|=Service|=Memory Limit|=CPU Limit|=Purpose
|Scanner|4GB|1.0 core|Heavy file processing
|PostgreSQL|1GB|0.5 core|Database operations
|Visualizer|512MB|0.5 core|Web dashboard
|Redis|256MB|0.25 core|Caching layer

== ğŸ” Scanning Process Flow ==

=== ğŸ“‹ Processing Pipeline ===

(% style="font-family: monospace; border: 1px solid #ccc; padding: 10px; background: #f9f9f9;" %)
(((
Input Files â†’ File Exclusion Filter â†’ Batch Processing (5 files) â†’ 
Multi-Engine Scanning â†’ OCR Text Extraction â†’ Database Storage â†’ 
Results Visualization
)))

=== ğŸ”§ Scan Engines ===

* **Custom Scanner**: Pattern-based secret detection with 200+ signatures
* **Gitleaks**: Git-aware secret scanning with entropy analysis
* **TruffleHog**: Deep credential discovery with verification
* **EasyOCR**: Image text extraction for embedded secrets

=== âš¡ Memory Optimization ===

* **Sequential Batching**: 5 files per batch to prevent memory spikes
* **Worker Limits**: Maximum 2 concurrent workers
* **File Exclusions**: Skip binary/media files (.pdf, .zip, .bmp, .prn)
* **OCR Pre-initialization**: Shared reader across all workers

== ğŸ“Š Monitoring & Analytics ==

=== ğŸ“ˆ Real-time Dashboard ===

**Access**: (% style="font-weight: bold;" %)http://your-server:8050(% style="font-weight: normal;" %) (Network accessible)

**Key Metrics Displayed:**
* Total files scanned with progress indicators
* Secrets discovered by severity (Critical/High/Medium/Low) 
* Scanner engine performance comparisons
* File type distribution analysis
* Scanning velocity (files/minute)
* System resource utilization

=== ğŸ”” Alert System ===

* **Critical Secrets**: Immediate dashboard notifications
* **Scan Completion**: Email/webhook notifications available
* **System Health**: Memory usage and error rate monitoring
* **File Changes**: Continuous monitoring with real-time alerts

== ï¿½ Security Features ==

=== ğŸ›¡ï¸ Data Protection ===

* **PostgreSQL Encryption**: Database-level encryption for sensitive findings
* **Redis Security**: Memory-only caching with automatic expiration
* **Network Isolation**: Docker network separation between services  
* **Access Controls**: Role-based dashboard access (configurable)

=== ï¿½ Privacy Controls ===

* **Secret Masking**: Partial redaction of discovered credentials
* **Audit Logging**: Complete access and discovery event logging
* **Data Retention**: Configurable cleanup policies
* **Export Controls**: Secure export with encryption options

== ğŸš€ Deployment Commands ==

=== ğŸ“¦ Quick Start ===

{{code language="bash"}}
# Clone repository
git clone <repository-url>
cd Secret_Snipe

# Configure environment
cp .env.example .env
nano .env  # Edit configuration

# Launch services
docker-compose up -d

# Monitor logs
docker-compose logs -f secretsnipe-scanner
{{/code}}

=== âš™ï¸ Environment Variables ===

|=Variable|=Purpose|=Example
|SCAN_PATH|Target directory|/mnt/shared/files
|DATABASE_URL|PostgreSQL connection|postgresql://user:pass@db:5432/secrets
|REDIS_URL|Cache connection|redis://cache:6379
|EXCLUDED_EXTENSIONS|Skip file types|.pdf,.zip,.bmp,.prn
|WORKER_PROCESSES|Concurrent workers|2
|SCANNER_TIMEOUT_SECONDS|Per-engine timeout|0 (disabled)

=== ï¿½ Management Commands ===

{{code language="bash"}}
# Start specific service
docker-compose up secretsnipe-scanner

# Scale workers (careful with memory!)
docker-compose up --scale secretsnipe-scanner=2

# Database backup
docker-compose exec secretsnipe-postgres pg_dump secrets > backup.sql

# Clean restart
docker-compose down && docker-compose up -d
{{/code}}

== ğŸ“ˆ Performance Metrics ==

=== âš¡ Current Performance ===

|=Metric|=Value|=Description
|**Files Processed**|~85,000|Total scannable files
|**Processing Rate**|~2-3 files/sec|With OCR enabled
|**Memory Usage**|<4GB|Peak during batch processing
|**Scan Duration**|~8-12 hours|Full directory scan
|**Detection Engines**|3 active|Custom + Gitleaks + Trufflehog

=== ğŸ¯ Optimization Results ===

(% style="color: green; border: 1px solid #4caf50; padding: 10px; background: #f1f8e9; margin: 10px 0;" %)
(((
**âœ… Memory Stability**: Fixed exit code 137 crashes through:
* Sequential batch processing (5 files at a time)
* Single OCR initialization (shared across workers)
* Aggressive garbage collection
* File exclusion strategy
)))

(% style="color: green; border: 1px solid #4caf50; padding: 10px; background: #f1f8e9; margin: 10px 0;" %)
(((
**âœ… Network Accessibility**: Dashboard available on network:
* Changed port binding from 127.0.0.1:8050 to 0.0.0.0:8050
* Maintained security through rate limiting and audit logging
)))

== ğŸ”„ Troubleshooting Guide ==

=== âŒ Common Issues & Solutions ===

|=Problem|=Symptom|=Solution
|**Scanner Crash**|Exit code 137|Check memory limits, reduce batch size
|**No Files Found**|0 files processed|Verify CIFS mount: `mount | grep secretsnipe`
|**Dashboard Access**|Connection refused|Check port mapping in docker-compose.yml
|**Database Issues**|Connection errors|Restart postgres service

=== ğŸ” Debug Commands ===

{{code language="bash"}}
# Check container resource usage
docker stats

# Verify environment variables
docker compose exec scanner env | grep -E "(EXCLUDED|OCR|WORKER)"

# Test scanner configuration
docker compose exec scanner python3 -c "from config import config; print(f'Workers: {config.scanner.threads}')"

# Monitor memory usage during scan
docker compose exec scanner top

# Check database connectivity
docker compose exec scanner python3 -c "from database_manager import db_manager; print('DB:', db_manager.test_connection())"
{{/code}}

----

(% style="text-align: center; margin: 30px 0; padding: 20px; background: #f8f9fa; border-radius: 8px;" %)
(((
=== ğŸ‰ System Status: **OPERATIONAL** ===
**//SecretSnipe is successfully monitoring your environment with multi-engine detection capabilities//**

**Dashboard**: `http://[your-server-ip]:8050` | **Version**: 1.0.0 | **Last Updated**: September 2025
)))